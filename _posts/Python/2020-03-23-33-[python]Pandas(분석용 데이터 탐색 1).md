---
title:  "[파이썬] Pandas-분석용 데이터 탐색(1)"
date: 2020-03-23
categories: ['python']
tags: ['python', '파이썬']
---
## 1. Pandas

- 데이터 분석, 처리 등을 쉽게 하도록 만들어진 파이썬 패키지이다.

- 대용량 데이터를 보다 쉽고 안정적으로 처리할 수 있다고 알려져 있다.

### 1) Pandas설치

- 명령 프롬프트에서 pip 명령어로 설치할 수 있다.

```
pip install pandas
```
<br>

#### 2) Pandas 자료구조

|종류|설명|
|:--:|:--|
|Series| value와 index의 형태를 지니는 1열로 구성된 자료 구조|
|DataFrame| 여러 개의 Dictionary를 처리하는데 있어 Series보다 보기 편한 형태의 자료 구조|

- Series : 엑셀의 각 열에 해당한다.

- DataFrame : 엑셀 표에 해당한다.

<br>

## 2. 시리즈(Series) 자료형

### 시리즈 생성하기 (1)

```python
# 모듈 참조
from pandas import Series

#기본 시리즈 만들기
# 리스트를 통해서 만들 수 있다.
# 리스트 자료형을 가공하여 생성된 데이터 구조
items = [10, 30, 50, 70, 90]
column = Series(items)

#전체 확인
print(column)
print('-'*30)

# 인덱스를 활용한 개별 값 확인
print(column[0])
print(column[2])
print(column[4])
print('-'*30)

# 시리즈의 값들만 추출
print(column.values)
print('-'*30)

# 타입을 확인하면 Numpy 배열임을 알 수 있다.
print(type(column.values))
```

```
0    10
1    30
2    50
3    70
4    90
dtype: int64
------------------------------
10
50
90
------------------------------
[10 30 50 70 90]
------------------------------
<class 'numpy.ndarray'>
```
<br>

### 시리즈 생성하기 (2)

```python
# 시리즈의 값들을 저장하고 있는 numpy 배열을 list로 변환
value_list = list(column.values)
print(value_list)
print('-'*30)

# 시리즈 색인 (index)만 추출
print(column.index)
print('-'*30)

# 색인들의 타입 확인
print(type(column.index))

#시리즈 색인(index)을 list로 변환
print(list(column.index))
print('-'*30)

#특정 조건에 맞는 항목들만 추출
# 이름[이름에 대한 조건식]
# 30초과인 항목들만 추출
in1 = column[column > 30]
print(type(in1))
print(in1)
```

```
[10, 30, 50, 70, 90]
------------------------------
RangeIndex(start=0, stop=5, step=1)
------------------------------
<class 'pandas.core.indexes.range.RangeIndex'>
[0, 1, 2, 3, 4]
------------------------------
<class 'pandas.core.series.Series'>
2    50
3    70
4    90
dtype: int64
```
<br>

### 시리즈 생성하기 (3)

```python
# 7이하 and 1초과인 항목들만 추출
in2 = column[column <= 70][column >10]
print(type(in2))
print(in2)
print("-"*30)

# 10이하 70이상인 항목들만 추출 (괄호 필수)
in3 = column[(column <=10)| (column >=70)]
print(type(in3))
print(in3)
print("-"*30)

# 인덱스를 직접 지정하면서 시리즈 만들기
# 지난 주말의 매출액
week1 = Series([290000, 310000], index=['sat', 'sun'])
# 이번 주말의 매출액
week2 = Series([120000, 220000], index=['sun', 'sat'])

print(week1)
print("-"*30)

print(week2)
print("-"*30)

# 시리즈 객체의 사칙연산
# index가 동일한 항목끼리 연산됨.
merge = week1 + week2
print(merge)
```

```
<class 'pandas.core.series.Series'>
1    30
2    50
3    70
dtype: int64
------------------------------
<class 'pandas.core.series.Series'>
0    10
3    70
4    90
dtype: int64
------------------------------
sat    290000
sun    310000
dtype: int64
------------------------------
sun    120000
sat    220000
dtype: int64
------------------------------
sat    510000
sun    430000
dtype: int64
```
<br>

## 3. 데이터 프레임 자료형

- 행(row)이 많은 경우

    - 100명의 데이터를 분석하다 자료가 많아져 10만명의 데이터를 분석하게 될 경우, 데이터 분석가는 성능 좋은 장비를 구축하여 문제를 해결할 수 있다.

    - 하드웨어의 사양을 높이거나 분산 처리 시스템(예: 하둡)을 구축

    - 행이 늘어나더라도 분석 기술에 있어 별다른 차이가 발생하지 않는다.

- 열(column)이 많은 경우

    - 변수를 조합할 수 있는 경우의 수가 늘어난다는 의미

    - 변수가 늘어나면 여러 변수의 영향을 동시에 고려할 수 있는 복잡한 분석 방법을 활용해야 함.

    - 변수가 많으면 적용하는 분석기술이 달라지므로 데이터 분석가의 노력이 필요함.

### 샘플데이터 복사하기

##### 샘플데이터 작성 (`sample.py`)

```python
#-----------------------------------------------------
# 데이터 프레임에서 사용할 샘플 데이터
#-----------------------------------------------------
# 어느 학급의 성적표를 표현한 2차원 리스트
grade_list = [  # 국  영  수  과
                 [98,  None, 88,   64],   # 철수
                 [88,  90,   62,   72],   # 영희
                 [92,  70,   None, None], # 민철
                 [63,  60,   31,   70],   # 수현
                 [120, 50,   None, 88]    # 호영
            ]

# 어느 학급의 성적표를 표현한 딕셔너리
grade_dic = {
    '국어': [98, 88, 92, 63, 120],
    '영어': [None, 90, 70, 60, 50],
    '수학': [88, 62, None, 31, None],
    '과학': [64, 72, None, 70, 88]
}

# 서울, 부산, 인천의 5년 단위 인구 분포
city_people = {
    "도시": ["서울", "서울", "서울", "부산", "부산", "부산", "인천", "인천"],
    "연도": ["2015", "2010", "2005", "2015", "2010", "2005", "2015", "2010"],
    "인구": [9904312, 9631482, 9762546, 3448737, 3393191, 3512547, 2890451, 2632035],
    "지역": ["수도권", "수도권", "수도권", "경상권", "경상권", "경상권", "수도권", "수도권"]
}

# 2017년 교통사고 조사
traffic = {
    'seoul'  : [ 3166, 2728, 3098, 3172, 3284, 3247, 3268, 3308, 3488, 3312, 3375, 3179 ],
    'busan'  : [ 927, 857, 988, 955, 1014, 974, 1029, 1040, 1058, 971, 958, 982 ],
    'daegu'  : [ 933, 982, 1049, 1032, 1083, 1117, 1076, 1080, 1174, 1163, 1146, 1135 ],
    'inchun' : [ 655, 586, 629, 669, 643, 627, 681, 657, 662, 606, 641, 663 ],
    'month'  : ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월']
}

# 어느 학교에서 임의로 선정한 학생들의 신장(cm단위)에 대한 자료
height = {
    '키': [170, 178, 171, 168, 173, 178, 171, 174, 170, 170,
           175, 170, 169, 166, 162, 170, 171, 175, 175, 171,
           170, 172, 179, 164, 170, 181, 178, 180, 177, 166,
           169, 168, 165, 163, 175, 166, 178, 165, 168, 167,
           177, 168, 177, 174, 174, 176, 169, 173, 167, 170,
           173, 170, 162, 182, 171]
}
```
<br>

#### 구현 코드 (1)

```python
# 모듈 참조
from pandas import DataFrame
from sample import grade_list
from sample import grade_dic

# 2차원 리스트를 데이터프레임으로 변환
# 학생별 점수 표현 (None은 값이 없음을 의미)
df = DataFrame(grade_list)
print(df)
print('-'*30)

# 각각의 데이터 열의 값과 타입 조회
# 각 열의 자료형 = Series (DataFrame은 Series의 모음)
print(df[0])
print(type(df[0]))
print('-'*30)

print(type(df[1]))
print(df[1])
```

```
     0     1     2     3
0   98   NaN  88.0  64.0
1   88  90.0  62.0  72.0
2   92  70.0   NaN   NaN
3   63  60.0  31.0  70.0
4  120  50.0   NaN  88.0
------------------------------
0     98
1     88
2     92
3     63
4    120
Name: 0, dtype: int64
<class 'pandas.core.series.Series'>
------------------------------
<class 'pandas.core.series.Series'>
0     NaN
1    90.0
2    70.0
3    60.0
4    50.0
Name: 1, dtype: float64

```
<br>

#### 구현 코드 (2)

```python
# 컬럼(열) 이름을 지정하여 새로 생성
# 컬럼의 이름을 갖고 있는 리스트를 지정한다.
c_names = ['국어', '영어', '수학', '과학']
df = DataFrame(grade_list, columns=c_names)
print(df)
print('-'*30)

#각각의 데이터 열의 값 조회
# 컬럼 이름이 지정되면 번호로 접근할 수 없다.
print(df['국어'])
print('-'*30)

print(df['영어'])
print('-'*30)
```

```
    국어    영어    수학    과학
0   98   NaN  88.0  64.0
1   88  90.0  62.0  72.0
2   92  70.0   NaN   NaN
3   63  60.0  31.0  70.0
4  120  50.0   NaN  88.0
------------------------------
0     98
1     88
2     92
3     63
4    120
Name: 국어, dtype: int64
------------------------------
0     NaN
1    90.0
2    70.0
3    60.0
4    50.0
Name: 영어, dtype: float64
```
<br>

#### 구현 코드 (3)

```python
# 인덱스(행) 이름을 지정하여 새로 생성
# 인덱스의 이름을 갖고 있는 리스트를 지정한다.
i_names = ['철수', '영희', '민철', '수현', '호영']
df = DataFrame(grade_list, index = i_names)
print(df)
print('-'*30)


# 인덱스와 컬럼 이름 모두 지정하기
df = DataFrame(grade_list, index =i_names, columns = c_names)
print(df)
print('-'*30)

# 딕셔너리를 통한 데이터 프레임 만들기
# 딕셔너리의 key는 DataFrame의 컬럼(열) 이름이 된다.
df = DataFrame(grade_dic)
print(df)
print('-'*30)

# 딕셔너리를 통한 데이터 프레임 만들기
# 딕셔너리의 key는 DataFrame의 컬럼(열) 이름이 된다.
df = DataFrame(grade_dic, index=['철수', '영희', '민철', '수현', '호영'])
print(df)
print('-'*30)
```

```
      0     1     2     3
철수   98   NaN  88.0  64.0
영희   88  90.0  62.0  72.0
민철   92  70.0   NaN   NaN
수현   63  60.0  31.0  70.0
호영  120  50.0   NaN  88.0
------------------------------
     국어    영어    수학    과학
철수   98   NaN  88.0  64.0
영희   88  90.0  62.0  72.0
민철   92  70.0   NaN   NaN
수현   63  60.0  31.0  70.0
호영  120  50.0   NaN  88.0
------------------------------
    국어    영어    수학    과학
0   98   NaN  88.0  64.0
1   88  90.0  62.0  72.0
2   92  70.0   NaN   NaN
3   63  60.0  31.0  70.0
4  120  50.0   NaN  88.0
------------------------------
     국어    영어    수학    과학
철수   98   NaN  88.0  64.0
영희   88  90.0  62.0  72.0
민철   92  70.0   NaN   NaN
수현   63  60.0  31.0  70.0
호영  120  50.0   NaN  88.0
------------------------------
```

참조 : 호쌤의 교육자료, (<https://blog.itpaper.co.kr/>)