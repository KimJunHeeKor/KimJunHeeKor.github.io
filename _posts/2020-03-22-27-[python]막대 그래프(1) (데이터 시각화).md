---
title:  "[파이썬] 막대 그래프(1) (데이터 시각화)"
date: 2020-03-22
categories: ['python']
tags: ['python', '파이썬']
---
## 1. 막대 그래프 그리기 기본 구조

- 막대 그래프 : 데이터 크기를 막대 길이로 표현한 그래프
    - `성별-소득차이` 처럼 집단간의 차이를 표현할 경우에 사용된다.

<br>

- 세로 막대 그래프 그리기
    - bar()함수에 x축과 y축에 표시될 리스트를 설정한다.

    ```python
    from matplotlib import pyplot

    #x축 데이터
    x = ['a','b','c','d']

    #y축 데이터
    y = [50, 80, 70, 30]

    pyplot.bar(x,y)
    ```
<br>

- pyplot 객체의 text 함수는 원하는 위치에 문자열을 표시하는 기능을 제공한다.
    ```
    가로방향 설정 가능한 값 : left, center, right

    세로방향 설정 가능한 값 : top, center, bottom
    ```

    - 예시코드

    ```python
    pyplot.text(keys[i], v, str_val, fontsize=9, color='#ff6600', horizontalalignment='center', verticalalignment='bottom')
    ```
    ![bar_top](/assets/Images/python/chapter27/1_bar.JPG)

<br>

#### 그래프 생성을 위한 `sample.py`

```python
#-----------------------------------------------------
# 그래프 그리기에서 사용될 샘플 데이터
#-----------------------------------------------------
# 년도별 신생아 수
newborn = [436455, 435435, 438420, 406243, 357771]
year = [2013, 2014, 2015, 2016, 2017]

# 2017년 1월~12월까지 도시별 교통사고 건수
seoul   = [ 3166, 2728, 3098, 3172, 3284, 3247, 3268, 3308, 3488, 3312, 3375, 3179 ]
busan   = [ 927, 857, 988, 955, 1014, 974, 1029, 1040, 1058, 971, 958, 982 ]
daegu   = [ 933, 982, 1049, 1032, 1083, 1117, 1076, 1080, 1174, 1163, 1146, 1135 ]
inchun  = [ 655, 586, 629, 669, 643, 627, 681, 657, 662, 606, 641, 663 ]
label = ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월']

# 어느 학생의 학년별 성적 변화
grade = {"1year": 72, "2year": 83, "3year": 64, "4year": 92}

# 온도와 아이스크림 판매 수량
tmp = [ 23, 25, 26, 27, 28, 29, 30, 31, 33 ]
qty = [ 21, 23, 25, 28, 33, 35, 36, 32, 39 ]


# 어벤져스 케릭터 인기 투표
vote = ["아이언맨", "캡틴아메리카", "호크아이", "아이언맨", "토르", "헐크", "아이언맨", "토르", "블랙위도우", "아이언맨", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "헐크", "아이언맨", "토르", "블랙위도우", "호크아이", "아이언맨", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "헐크", "아이언맨", "토르", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "헐크", "아이언맨", "토르", "아이언맨", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "호크아이", "토르", "헐크", "아이언맨", "토르", "아이언맨", "블랙위도우", "토르", "헐크", "아이언맨", "토르", "블랙위도우", "토르", "헐크", "아이언맨", "아이언맨", "호크아이", "토르", "블랙위도우", "아이언맨", "토르", "아이언맨", "토르", "아이언맨", "토르", "아이언맨", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "캡틴아메리카", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "캡틴아메리카", "헐크", "아이언맨", "토르", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "헐크", "아이언맨", "토르", "아이언맨", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "캡틴아메리카", "토르", "헐크", "아이언맨", "토르", "캡틴아메리카", "캡틴아메리카", "캡틴아메리카", "블랙위도우", "아이언맨", "호크아이", "캡틴아메리카", "아이언맨", "토르", "헐크", "아이언맨", "아이언맨", "토르", "블랙위도우", "아이언맨", "캡틴아메리카", "아이언맨", "아이언맨", "아이언맨", "아이언맨", "토르", "헐크", "캡틴아메리카", "캡틴아메리카", "아이언맨", "토르", "블랙위도우", "토르", "헐크", "아이언맨", "토르", "블랙위도우", "토르", "캡틴아메리카", "헐크", "아이언맨", "토르", "블랙위도우", "아이언맨", "토르", "아이언맨", "토르", "아이언맨", "토르", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "아이언맨", "캡틴아메리카", "아이언맨", "토르", "블랙위도우"]

# 철수의 중간,기말고사 성적표
grade_card = {
    "중간고사": {
        "국어": 90, "영어": 72, "수학": 88, "과학": 98, "한국사": 86
    },
    "기말고사": {
        "국어": 81, "영어": 65, "수학": 78, "과학": 78, "한국사": 62
    }
}

```
<br>

#### 구현 코드

```python
#모듈 및 데이터 참조
from matplotlib import pyplot
from sample import vote
# collections 모듈의 Counter클래스는 생성자 파라미터로 전달된 리스트의
# 빈도수를 측정한다.
from collections import Counter

#리스트의 각 원소별 빈도수 측정
cnt = Counter(vote) #Counter({ '아이언맨': 59, '토르': 38, '캡틴아메리카': 23, '블랙위도우': 16, '헐크': 14, '호크아이': 5 })

#결과를 딕셔너리로 변환
cnt_dict = dict(cnt)    #{'아이언맨': 59, '캡틴아메리카': 23, '호크아이': 5, '토르': 38, '헐크': 14, '블랙위도우': 16}

# 변환된 결과에서 value로 구성된 리스트 추출
values = list(cnt_dict.values())    #[59, 23, 5, 38, 14, 16]

# 변환된 결과에서 key로 구성된 리스트 추출
keys = list(cnt_dict.keys())    #['아이언맨', '캡틴아메리카', '호크아이', '토르', '헐크', '블랙위도우']

# 한글폰트 설정 및 그래프 크기 설정
pyplot.rcParams['font.family']='NanumGothic'
pyplot.rcParams['font.size']=12
pyplot.rcParams['figure.figsize']=(12,8)

#그래프 설정 시작
pyplot.figure()

#세로 막대 그래프
#x, y축, 그래프의 범주 설정
pyplot.bar(keys, values, label='득표수')   #막대 그래프 표현
pyplot.legend()                           #범주 표시
pyplot.xlabel('캐릭터')                    # x축 레이블
pyplot.ylabel('득표수')                    # y축 레이블
pyplot.title('어벤져스 인기투표')           # 그래프 제목
pyplot.grid()                              # 격자 선 표시

# 그래프의 데이터 수 만큼 반복하면서 텍스트 표시하기
for i, v in enumerate(values):
    #표시할 텍스트
    str_val = "%d표" % v

    #x축 좌표, y축 좌표, 표시문구, 글자크기, 색상, 가로/세로 정렬
    pyplot.text(keys[i], v, str_val, fontsize=9, color='#ff6600', horizontalalignment='center', verticalalignment='bottom')

#그래프 저장
pyplot.savefig('avengers.png')

pyplot.close()
```

![2_plot](/assets/Images/python/chapter27/2_plot.JPG)
<br><br>

## 2. x축 좌표를 기준으로 설정한 막대 그래프

    sample.py 는 위의 코드를 참조

<br>

#### 구현 코드

```python
#모듈 참조
from matplotlib import pyplot

#2013 ~ 2017년도 신생아 수
from sample import newborn

# x축의 좌표로 사용하기 위해 0부터 시작하는 리스트 생성
x = list(range(0, len(newborn)))        #[0, 1, 2, 3, 4]

# 한글폰트 설정 및 그래프 크기 설
pyplot.rcParams['font.family']='NanumGothic'
pyplot.rcParams['font.size']=12
pyplot.rcParams['figure.figsize']=(12,8)

#그래프 설정 시작
pyplot.figure()

#세로 막대 그래프
#x, y축, 그래프의 범주 설정
pyplot.bar(x, newborn, label='신생아 수', color="#ecc2f9")   #막대 그래프 표현
pyplot.legend()                           #범주 표시
pyplot.xlabel('연도')                      # x축 레이블
pyplot.ylabel('신생아 수')                  # y축 레이블
pyplot.title('2013 ~ 2017년도 신생아 수')   # 그래프 제목
pyplot.grid()                              # 격자 선 표시정

#그래프의 x좌표에 표시될 텍스트 설정
pyplot.xticks(x, ['2013년','2014년','2015년','2016년','2017년'])

#그래프의 데이터 수 만큼 반복하면서 텍스트 표시하기
for i, v in enumerate(newborn):
    #표시할 텍스트
    str_val ="%d명" % v

    #x축 좌표, y축 좌표, 표시문구, 글자크기, 색상, 가로/세로 정렬
    pyplot.text(x[i], v, str_val, fontsize=9, color='#ff0000', horizontalalignment='center', verticalalignment='bottom')

#y축 범위를 조절하여 전달하고자 하는 스토리를 극대화 하기
pyplot.ylim(300000, 450000)

#그래프 이미지 저장
pyplot.savefig('newborn.png',dpi=200)

#그래프 관련 설정 해제
pyplot.close()
```

![plot2](/assets/Images/python/chapter27/3_plot2.JPG)


참조 : 호쌤의 교육자료, (<https://blog.itpaper.co.kr/>)